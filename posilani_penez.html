<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>RP – Posílání peněz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- FontAwesome -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer">

  <style>
    :root {
      --bottom-bar-height: 65px;
      --bottom-icon-box: 60px;
      --bottom-icon-font: 50px;
      --blue: #2876de;
      --orange: #ff8a2b;
      --grey-bg: #f3f5f7;
      --green: #32d180;
    }

    * , *::before, *::after { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #111;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      overflow: hidden;
    }

    .mobile-frame {
      width: 420px;
      height: 95vh;
      max-height: 860px;
      border-radius: 36px;
      background: #000;
      box-shadow: 0 22px 50px rgba(0,0,0,0.7);
      overflow: hidden;
      position: relative;
      display: flex;
      flex-direction: column;
    }

    .app-screen {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: #f4f4f4;
      height: 100%;
      position: relative;
    }

    /* HORNÍ LIŠTA */
    .app-header {
      height: 70px;
      background: var(--blue);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 18px;
      flex-shrink: 0;
    }

    .logo-wrap {
      display: flex;
      align-items: center;
      gap: 6px;
      color: #fff;
    }

    .logo-img { height: 50px; }

    .hamburger {
      width: 28px;
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .hamburger span {
      height: 3px;
      border-radius: 999px;
      background: #fff;
    }

    /* HLAVNÍ OBSAH */
    .app-content {
      flex: 1 1 auto;
      overflow-y: auto;
      overflow-x: hidden;
      padding: 14px 14px 10px;
      background: var(--grey-bg);
    }

    /* ZŮSTATEK */
    .card {
      background: #fff;
      border-radius: 18px;
      padding: 16px 18px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.06);
      display: flex;
      align-items: center;
      margin-bottom: 14px;
    }

    .card-icon {
      width: 52px;
      height: 52px;
      border-radius: 50%;
      background: #e5e5e5;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 14px;
      color: #9e9e9e;
      font-size: 26px;
      cursor: pointer;
    }

    .card-text-main { display: flex; flex-direction: column; gap: 3px; }

    .card-label  { font-size: 18px; color: #b5b5b5; }
    .card-amount { font-size: 22px; color: #ff7a28; font-weight: 600; }

    @keyframes spin-refresh {
      from { transform: rotate(0deg); }
      to   { transform: rotate(360deg); }
    }
    .card-icon i.spinning { animation: spin-refresh 0.45s linear 3; }

    /* PANEL POSLAT PENÍZE */
    .send-panel {
      margin-top: 18px;
      background: #ffffff;
      border-radius: 18px;
      padding: 18px 18px 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.04);
    }

    .send-title {
      margin: 0 0 4px;
      font-size: 20px;
      font-weight: 600;
    }

    .send-sub {
      margin: 0 0 6px;
      font-size: 13px;
      color: #777;
    }

    .send-subheading {   /* Tuzemská platba – NOVÉ */
      margin: 0 0 12px;
      font-size: 14px;
      font-weight: 600;
      color: #444;
    }

    /* TABY */
    .send-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 10px;
    }

    .send-tab {
      flex: 1;
      border-radius: 999px;
      border: 1px solid #e0e0e0;
      padding: 8px 10px;
      font-size: 13px;
      font-weight: 600;
      background: #f5f5f5;
      color: #666;
      cursor: pointer;
      text-align: center;
      transition: all 0.15s ease;
      white-space: nowrap;
    }

    .send-tab.active {
      background: var(--blue);
      border-color: var(--blue);
      color: #fff;
      box-shadow: 0 2px 6px rgba(40,118,222,0.35);
    }

    .field-label {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .field-helper {
      font-size: 11px;
      color: #777;
      margin: 2px 0 10px;
    }

    .input-row {
      border-radius: 999px;
      border: 1px solid #ddd;
      padding: 6px 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      background: #fafafa;
      margin-bottom: 6px;
    }

    .input-row.focused {
      border-color: var(--blue);
      box-shadow: 0 0 0 1px rgba(40,118,222,0.2);
    }

    .input-prefix {
      font-size: 13px;
      color: #777;
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .text-input {
      flex: 1;
      border: none;
      background: transparent;
      font-size: 15px;
      outline: none;
    }

    .text-input::placeholder {
      color: #bbb;
    }

    .status-pill {
      margin-top: 8px;
      border-radius: 999px;
      font-size: 12px;
      padding: 6px 10px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .status-pill.ok {
      background: #e8f5e9;
      color: #2e7d32;
    }
    .status-pill.err {
      background: #ffebee;
      color: #c62828;
    }

    .status-pill i {
      font-size: 13px;
    }

    .btn-inline {
      border-radius: 999px;
      border: none;
      padding: 7px 12px;
      font-size: 12px;
      font-weight: 600;
      background: var(--blue);
      color: #fff;
      cursor: pointer;
      white-space: nowrap;
    }

    .btn-inline:disabled {
      background: #cfd8e5;
      cursor: default;
    }

    /* ČÁSTKA */
    .amount-wrapper {
      border-radius: 999px;
      border: 1px solid #ff8a2b;
      padding: 6px 12px;
      display: flex;
      align-items: center;
      gap: 10px;
      background: #fffdf8;
      margin: 10px 0 6px;
      transition: border-color 0.15s ease, box-shadow 0.15s ease;
    }

    .amount-currency {
      font-size: 14px;
      font-weight: 600;
      color: #ff8a2b;
      white-space: nowrap;
    }

    .amount-input {
      flex: 1;
      border: none;
      background: transparent;
      font-size: 18px;
      font-weight: 600;
      outline: none;
      text-align: right;
      padding-right: 10px;
    }

    .amount-input::placeholder {
      color: #ccc;
      font-weight: 400;
    }

    .amount-error {
      font-size: 12px;
      color: #e53935;
      margin-bottom: 4px;
      display: none;
    }

    .amount-error.visible { display: block; }

    /* Extra pole pro bankovní převod – vždy viditelné */
    .bank-extra {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid #f0f0f0;
    }

    .bank-extra-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px 10px;
      margin-bottom: 10px;
    }

    .small-input {
      width: 100%;
      border-radius: 10px;
      border: 1px solid #ddd;
      padding: 6px 10px;
      font-size: 13px;
      outline: none;
    }

    .small-input:focus {
      border-color: var(--blue);
      box-shadow: 0 0 0 1px rgba(40,118,222,0.2);
    }

    .bank-extra-grid .full-width {
      grid-column: 1 / -1;
    }

    /* ŘÁDEK: kód banky + Vybrat šablonu – NOVÉ */
    .bank-code-row {
      display: flex;
      gap: 8px;
      margin-bottom: 6px;
    }

    .bank-code-row .input-row {
      flex: 1;
      margin-bottom: 0;
    }

    .btn-template {
      border-radius: 999px;
      border: 1px solid var(--blue);
      background: #eaf2ff;
      color: var(--blue);
      padding: 8px 10px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      white-space: nowrap;
      flex-shrink: 0;
    }

    /* ODESLAT */
    .btn-main {
      margin-top: 14px;
      width: 100%;
      border-radius: 999px;
      border: none;
      padding: 11px 18px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      background: var(--blue);
      color: #ffffff;
      transition: opacity 0.15s ease, transform 0.05s ease, background 0.15s ease;
    }

    .btn-main:active:not(.btn-disabled) { transform: scale(0.98); }

    .btn-main.btn-disabled {
      background: #cfd8e5;
      cursor: default;
      opacity: 0.85;
    }

    .btn-main.btn-green {         /* zelené tlačítko – NOVÉ */
      background: var(--green);
    }

    .btn-main.btn-grey {          /* šedé sekundární – NOVÉ */
      background: #e0e0e0;
      color: #444;
    }

    /* Sekce po odeslání / při editaci šablony – NOVÉ */
    .after-send {
      margin-top: 10px;
    }

    .template-name-label {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 6px;
      color: #444;
    }

    .template-name-input-row {
      display: flex;
      gap: 8px;
      margin-bottom: 8px;
    }

    .template-name-input-row input {
      flex: 1;
      border-radius: 999px;
      border: 1px solid #ddd;
      padding: 7px 12px;
      font-size: 13px;
      outline: none;
    }

    .template-name-input-row input:focus {
      border-color: var(--blue);
      box-shadow: 0 0 0 1px rgba(40,118,222,0.2);
    }

    .save-template-wrapper {
      margin-top: 10px;
      display: flex;
      flex-direction: column;   /* pod sebe */
      align-items: center;      /* na střed */
      gap: 8px;
    }

    .save-template-wrapper input {
      width: 100%;              /* pole přes celou šířku panelu */
    }

    .save-template-wrapper .btn-save-template {
      min-width: 60%;           /* aby nebylo moc úzké */
    }


    /* SPODNÍ LIŠTA */
    .bottom-bar {
      height: var(--bottom-bar-height);
      background: var(--blue);
      display: flex;
      align-items: center;
      justify-content: space-around;
      padding: 0 8px;
      flex-shrink: 0;
    }

    .bottom-link {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
    }

    .bottom-icon-inner {
      width: var(--bottom-icon-box);
      height: var(--bottom-icon-box);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: var(--bottom-icon-font);
    }

    .bottom-icon-inner.plus-icon { background: transparent; }

    .plus-box {
      width: 45px;
      height: 45px;
      border-radius: 10px;
      background: #ffffff;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .plus-box i {
      color: #2876de;
      font-size: 26px;
    }

    /* MENU ŘÁDKY – Přehled / Transakce / Karty / Notifikace */
    .menu-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 20px;
    }

    .menu-item {
      background: #fff;
      border-radius: 18px;
      padding: 12px 18px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.06);
      display: flex;
      align-items: center;
    }

    .menu-left {
      display: flex;
      align-items: center;
      width: 100%;
      gap: 16px;
    }

    .menu-icon {
      width: 52px;
      height: 52px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 26px;
      flex-shrink: 0;
      position: relative;
    }

    .menu-icon.search { background: #2f7eea; }
    .menu-icon.coins  { background: #2fb2ff; }
    .menu-icon.minus  { background: #32d1a2; }
    .menu-icon.bell   { background: #ff8b39; }

    .menu-label {
      font-size: 18px;
      color: #111;
      margin-left: auto;
      text-align: right;
    }

    /* BADGE + stav pro Notifikace (stejně jako ve vkladu) */
    .notif-badge {
      position: absolute;
      right: 4px;
      bottom: 4px;
      min-width: 16px;
      height: 16px;
      padding: 0 4px;
      border-radius: 999px;
      background: #ff3b30;
      color: #ffffff;
      font-size: 10px;
      font-weight: 700;
      display: none;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 0 2px #ffffff;
    }

    .menu-item.notifications.disabled {
      pointer-events: none;
    }

    .menu-item.notifications.enabled {
      cursor: pointer;
    }

    /* TOAST notifikace */
    .toast {
      position: absolute;
      left: 50%;
      bottom: calc(var(--bottom-bar-height) + 14px);
      transform: translateX(-50%);
      background: #323232;
      color: #fff;
      padding: 10px 16px;
      border-radius: 999px;
      font-size: 13px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.25s ease, transform 0.25s ease;
      max-width: 90%;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      z-index: 50;
    }

    .toast.show {
      opacity: 1;
      transform: translate(-50%, -4px);
    }

    /* MODAL – ověření platby (PIN + Face ID) */
    .auth-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.45);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 60;
    }

    .auth-backdrop.visible {
      display: flex;
    }

    .auth-modal {
      width: 85%;
      max-width: 360px;
      background: #ffffff;
      border-radius: 20px;
      padding: 18px 18px 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.35);
    }

    .auth-title {
      margin: 0 0 4px;
      font-size: 18px;
      font-weight: 600;
    }

    .auth-sub {
      margin: 0 0 14px;
      font-size: 13px;
      color: #666;
    }

    .auth-pin-input {
      width: 100%;
      border-radius: 12px;
      border: 1px solid #ddd;
      padding: 8px 10px;
      font-size: 18px;
      text-align: center;
      letter-spacing: 4px;
      outline: none;
    }

    .auth-pin-input:focus {
      border-color: var(--blue);
      box-shadow: 0 0 0 1px rgba(40,118,222,0.25);
    }

    .auth-error {
      margin-top: 6px;
      font-size: 12px;
      color: #c62828;
      min-height: 16px;
    }

    .auth-actions {
      margin-top: 14px;
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }

    .btn-secondary {
      border-radius: 999px;
      border: none;
      padding: 8px 14px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      background: #eceff1;
      color: #333;
    }

    .btn-secondary:active {
      transform: scale(0.98);
    }

    .btn-primary {
      border-radius: 999px;
      border: none;
      padding: 8px 16px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      background: var(--blue);
      color: #fff;
    }

    .btn-primary:active {
      transform: scale(0.98);
    }

    .face-step {
      text-align: center;
      padding-top: 6px;
    }

    .face-icon {
      font-size: 42px;
      color: var(--blue);
      margin-bottom: 10px;
    }

    .face-text {
      font-size: 13px;
      color: #555;
      margin-bottom: 12px;
    }

    /* MODAL – fotoaparát (demo) – NOVÉ */
    .modal-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.45);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 55;
    }

    .modal-backdrop.visible {
      display: flex;
    }

    .simple-modal {
      width: 85%;
      max-width: 360px;
      background: #ffffff;
      border-radius: 20px;
      padding: 18px 18px 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.35);
      text-align: center;
    }

    .simple-modal-title {
      margin: 0 0 8px;
      font-size: 18px;
      font-weight: 600;
    }

    .simple-modal-text {
      font-size: 13px;
      color: #555;
      margin-bottom: 16px;
    }

    /* MODAL – výběr šablony – NOVÉ */
    .template-modal {
      width: 90%;
      max-width: 380px;
      background: #ffffff;
      border-radius: 20px;
      padding: 16px 14px 14px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.35);
    }

    .template-modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .template-modal-title {
      font-size: 16px;
      font-weight: 600;
    }

    .template-modal-close {
      border: none;
      background: transparent;
      font-size: 18px;
      cursor: pointer;
      color: #555;
    }

    .template-table-head,
    .template-row {
      display: grid;
      grid-template-columns: 2fr 2fr 1fr 1fr auto;
      align-items: center;
      column-gap: 6px;
      font-size: 11px;
    }

    .template-table-head {
      font-weight: 600;
      color: #666;
      margin-bottom: 4px;
    }

    .template-table-body {
      max-height: 210px;
      overflow-y: auto;
      padding-right: 2px;
    }

    .template-row {
      padding: 6px 4px;
      border-radius: 10px;
      cursor: pointer;
    }

    .template-row:nth-child(odd) {
      background: #f7f9fc;
    }

    .template-row:hover {
      background: #eaf2ff;
    }

    .template-actions {
      display: flex;
      gap: 6px;
      justify-content: flex-end;
    }

    .template-icon-btn {
      border: none;
      background: transparent;
      cursor: pointer;
      padding: 2px;
      font-size: 13px;
    }

    .template-icon-btn.edit { color: #2876de; }
    .template-icon-btn.delete { color: #e53935; }

  </style>
</head>
<body>
  <div class="mobile-frame">
    <div class="app-screen">

      <!-- HORNÍ LIŠTA -->
      <header class="app-header">
        <div class="logo-wrap">
          <img src="https://rychlapenezenka.cz/images/rp_cerna-bila.png" alt="RP logo" class="logo-img">
        </div>
        <div class="hamburger">
          <span></span><span></span><span></span>
        </div>
      </header>

      <!-- OBSAH -->
      <main class="app-content">

        <!-- ZŮSTATEK -->
        <section class="card">
          <div class="card-icon">
            <i class="fa-solid fa-arrows-rotate"></i>
          </div>
          <div class="card-text-main">
            <div class="card-label">Váš zůstatek</div>
            <div class="card-amount" id="balanceAmount">262.12 CZK</div>
          </div>
        </section>

        <!-- Menu položky (informativní, jako jinde) -->
        <section class="menu-list">
          <div class="menu-item">
            <div class="menu-left">
              <div class="menu-icon search">
                <i class="fa-solid fa-magnifying-glass"></i>
              </div>
              <div class="menu-label">Přehled</div>
            </div>
          </div>

          <div class="menu-item">
            <div class="menu-left">
              <div class="menu-icon coins">
                <i class="fa-solid fa-coins"></i>
              </div>
              <div class="menu-label">Transakce</div>
            </div>
          </div>

          <div class="menu-item">
            <div class="menu-left">
              <div class="menu-icon minus">
                <i class="fa-solid fa-credit-card"></i>
              </div>
              <div class="menu-label">Karty</div>
            </div>
          </div>

          <!-- Notifikace s badge + stavem disabled/enabled -->
          <div class="menu-item notifications disabled" id="notificationsRow">
            <div class="menu-left">
              <div class="menu-icon bell">
                <i class="fa-solid fa-bell"></i>
                <span class="notif-badge" id="notifBadge">1</span>
              </div>
              <div class="menu-label">Notifikace</div>
            </div>
          </div>
        </section>


        <!-- PANEL POSLAT PENÍZE -->
        <section class="send-panel">
          <h1 class="send-title">Poslat peníze</h1>
          <p class="send-sub">
            Disponibilní zůstatek: <strong id="sendBalance">262,12 CZK</strong>
          </p>

          <!-- TABY – Bankovní převod vlevo, default aktivní -->
          <div class="send-tabs">
            <button class="send-tab active" id="tabBank">Bankovní převod</button>
            <button class="send-tab" id="tabWallet">Mezi peněženkami</button>
          </div>

          <!-- MEZI PENĚŽENKAMI -->
          <div id="walletSection" style="display:none;">
            <div class="field-label">Příjemce</div>
            <div class="input-row" id="walletRow">
              <span class="input-prefix">@</span>
              <input
                id="walletRecipient"
                class="text-input"
                type="email"
                placeholder="e-mail příjemce nebo telefon">
              <button id="btnCheckRecipient" class="btn-inline">Zkontrolovat</button>
            </div>
            <div id="walletStatus"></div>

            <div class="field-label" style="margin-top:16px;">Částka</div>
            <div class="amount-wrapper">
              <span class="amount-currency">CZK</span>
              <input
                id="walletAmount"
                class="amount-input"
                type="tel"
                inputmode="numeric"
                placeholder="0,00">
            </div>
            <div id="walletAmountError" class="amount-error">
              Nemůžete poslat víc než je zůstatek Vaší peněženky.
            </div>
            <div class="field-helper">
              Maximálně do výše zůstatku Vaší peněženky.
            </div>
          </div>

          <!-- NA BANKOVNÍ ÚČET -->
          <div id="bankSection">

            <h2 class="send-subheading">Tuzemská platba</h2>

            <div class="field-label">Číslo účtu</div>
            <div class="input-row">
              <span class="input-prefix">
                <i class="fa-solid fa-building-columns"></i>
              </span>
              <input
                id="bankAccount"
                class="text-input"
                type="text"
                placeholder="1234567890">
              <!-- Fotoaparát – demo -->
              <button id="btnCamera" class="template-icon-btn edit" type="button" title="Naskenovat číslo účtu (demo)">
                <i class="fa-solid fa-camera"></i>
              </button>
            </div>

            <div class="field-label">Kód banky</div>
            <div class="bank-code-row">
              <div class="input-row">
                <span class="input-prefix">kód</span>
                <input
                  id="bankCode"
                  class="text-input"
                  type="text"
                  placeholder="0800">
              </div>
              <button id="btnOpenTemplates" class="btn-template" type="button">
                Vybrat šablonu
              </button>
            </div>

            <div class="bank-extra" id="bankExtra">
              <div class="bank-extra-grid">
                <div class="full-width">
                  <div class="field-label" style="font-size:12px;">Jméno / název příjemce</div>
                  <input id="bankRecipientName" class="small-input" type="text" placeholder="Jméno nebo název společnosti">
                </div>
                <div>
                  <div class="field-label" style="font-size:12px;">Variabilní symbol</div>
                  <input id="vsInput" class="small-input" type="text" placeholder="VS">
                </div>
                <div>
                  <div class="field-label" style="font-size:12px;">Specifický symbol</div>
                  <input id="ssInput" class="small-input" type="text" placeholder="SS">
                </div>
                <div>
                  <div class="field-label" style="font-size:12px;">Konstantní symbol</div>
                  <input id="ksInput" class="small-input" type="text" placeholder="KS">
                </div>
                <div class="full-width">
                  <div class="field-label" style="font-size:12px;">Poznámka pro příjemce</div>
                  <input id="msgRecipientInput" class="small-input" type="text" placeholder="Zpráva na výpisu příjemce">
                </div>
                <div class="full-width">
                  <div class="field-label" style="font-size:12px;">Poznámka pro mě</div>
                  <input id="msgMeInput" class="small-input" type="text" placeholder="Interní poznámka (viditelná jen pro vás)">
                </div>
              </div>

              <div class="field-label">Částka</div>
              <div class="amount-wrapper">
                <span class="amount-currency">CZK</span>
                <input
                  id="bankAmount"
                  class="amount-input"
                  type="tel"
                  inputmode="numeric"
                  placeholder="0,00">
              </div>
              <div id="bankAmountError" class="amount-error">
                Nemůžete poslat víc než je zůstatek Vaší peněženky.
              </div>
            </div>
          </div>

          <!-- SPOLEČNÉ TLAČÍTKO -->
          <button id="btnSend" class="btn-main btn-disabled" disabled>
            Odeslat platbu
          </button>

          <!-- Sekce po odeslání / při editaci šablony – NOVÉ -->
          <div id="afterSendArea" class="after-send" style="display:none;">
            <div id="templatePrimaryArea"></div>
            <button id="btnNewPayment" class="btn-main btn-grey" type="button" style="margin-top:8px;">
              Odeslat novou platbu
            </button>
          </div>

        </section>
      </main>

      <!-- TOAST NOTIFIKACE -->
      <div id="toast" class="toast"></div>

      <!-- MODAL – fotoaparát (demo) -->
      <div id="cameraBackdrop" class="modal-backdrop">
        <div class="simple-modal">
          <h2 class="simple-modal-title">Naskenovat číslo účtu</h2>
          <p class="simple-modal-text">
            Demo: zde by bylo focení čísla účtu. Pro ukázku můžete předvyplnit testovací číslo účtu.
          </p>
          <button id="btnCameraFill" class="btn-main btn-green" type="button" style="margin-top:8px;">
            Vyplnit demo číslo účtu
          </button>
          <div style="margin-top:10px;">
            <button id="btnCameraClose" class="btn-secondary" type="button">Zavřít</button>
          </div>
        </div>
      </div>

      <!-- MODAL – výběr šablony -->
      <div id="templateBackdrop" class="modal-backdrop">
        <div class="template-modal">
          <div class="template-modal-header">
            <div class="template-modal-title">Vybrat šablonu</div>
            <button id="btnTemplateClose" class="template-modal-close" type="button">
              <i class="fa-solid fa-xmark"></i>
            </button>
          </div>

          <div class="template-table-head">
            <div>Název</div>
            <div>Účet + kód</div>
            <div>VS</div>
            <div>Částka</div>
            <div></div>
          </div>
          <div id="templateTableBody" class="template-table-body">
            <!-- řádky se doplní z JS -->
          </div>
        </div>
      </div>

      <!-- MODAL – ověření platby -->
      <div id="authBackdrop" class="auth-backdrop">
        <div class="auth-modal">
          <!-- KROK 1: PIN -->
          <div id="pinStep">
            <h2 class="auth-title">Ověření platby</h2>
            <p class="auth-sub">Zadejte PIN k peněžence.</p>
            <input
              id="pinInput"
              class="auth-pin-input"
              type="password"
              inputmode="numeric"
              maxlength="4"
              autocomplete="off"
              placeholder="••••">
            <div id="pinError" class="auth-error"></div>
            <div class="auth-actions">
              <button id="btnAuthCancel1" class="btn-secondary">Zrušit</button>
              <button id="btnPinOk" class="btn-primary">Potvrdit PIN</button>
            </div>
          </div>

          <!-- KROK 2: Face ID -->
          <div id="faceStep" style="display:none;">
            <h2 class="auth-title">Ověření Face ID</h2>
            <div class="face-step">
              <div class="face-icon">
                <i class="fa-regular fa-face-smile"></i>
              </div>
              <p class="face-text">
                Podívejte se na obrazovku pro ověření Face ID (demo).
              </p>
            </div>
            <div class="auth-actions">
              <button id="btnAuthCancel2" class="btn-secondary">Zrušit</button>
              <button id="btnFaceOk" class="btn-primary">Ověřit</button>
            </div>
          </div>
        </div>
      </div>

      <!-- SPODNÍ LIŠTA -->
      <nav class="bottom-bar">
        <a href="prehled.html" class="bottom-link">
          <div class="bottom-icon-inner">
            <i class="fa-solid fa-money-bill-transfer"></i>
          </div>
        </a>

        <a href="prehled.html" class="bottom-link">
          <div class="bottom-icon-inner plus-icon">
            <div class="plus-box">
              <i class="fa-solid fa-plus"></i>
            </div>
          </div>
        </a>

        <a href="posilani_penez.html" class="bottom-link">
          <div class="bottom-icon-inner">
            <i class="fa-solid fa-hand-holding-dollar"></i>
          </div>
        </a>

        <a href="sporeni.html" class="bottom-link">
          <div class="bottom-icon-inner">
            <i class="fa-solid fa-piggy-bank"></i>
          </div>
        </a>
      </nav>

    </div>
  </div>

  <script>
    // jednoduchý zůstatek
    let currentBalance = 262.12;
    const balanceAmountEl = document.getElementById("balanceAmount");
    const sendBalanceEl   = document.getElementById("sendBalance");

    // NOTIFIKACE – badge u zvonku (stejné jako u vkladu)
    const notifBadge        = document.getElementById("notifBadge");
    const notificationsRow  = document.getElementById("notificationsRow");
    let notifCount = 0;

    function showNewNotification() {
      notifCount += 1;
      if (notifBadge) {
        notifBadge.textContent = notifCount;
        notifBadge.style.display = "flex";
      }
      enableNotificationsRow();
    }

    function enableNotificationsRow() {
      if (!notificationsRow) return;
      notificationsRow.classList.remove("disabled");
      notificationsRow.classList.add("enabled");

      // jen jednou – po prvním odemknutí
      notificationsRow.addEventListener("click", () => {
        window.location.href = "notifikace_od_plateb.html";
      }, { once: true });
    }

    // MODAL – ověření platby
    const authBackdrop   = document.getElementById("authBackdrop");
    const pinStep        = document.getElementById("pinStep");
    const faceStep       = document.getElementById("faceStep");
    const pinInput       = document.getElementById("pinInput");
    const pinError       = document.getElementById("pinError");
    const btnPinOk       = document.getElementById("btnPinOk");
    const btnFaceOk      = document.getElementById("btnFaceOk");
    const btnAuthCancel1 = document.getElementById("btnAuthCancel1");
    const btnAuthCancel2 = document.getElementById("btnAuthCancel2");

    let pendingTransaction = null; // { mode: 'wallet' | 'bank', amount: number }

    function formatAmountCZK(amount) {
      return amount.toLocaleString("cs-CZ", {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      });
    }

    function renderBalance() {
      const formatted = formatAmountCZK(currentBalance);
      if (balanceAmountEl) balanceAmountEl.textContent = formatted + " CZK";
    }
    renderBalance(); // horní zůstatek hned po načtení

    // toast notifikace
    function showNotification(message) {
      const toast = document.getElementById("toast");
      if (!toast) {
        alert(message);
        return;
      }
      toast.textContent = message;
      toast.classList.add("show");
      setTimeout(() => {
        toast.classList.remove("show");
      }, 3000);
    }

    // MODAL flow
    function openAuthFlow(mode, amount) {
      pendingTransaction = { mode, amount };
      // krok 1 – PIN
      pinStep.style.display  = "";
      faceStep.style.display = "none";
      pinInput.value = "";
      pinError.textContent = "";
      authBackdrop.classList.add("visible");
      setTimeout(() => pinInput.focus(), 50);
    }

    function closeAuthFlow() {
      authBackdrop.classList.remove("visible");
      pendingTransaction = null;
    }

    function goToFaceStep() {
      pinStep.style.display  = "none";
      faceStep.style.display = "";
    }

    btnAuthCancel1.addEventListener("click", closeAuthFlow);
    btnAuthCancel2.addEventListener("click", closeAuthFlow);

    // Demo PIN – 1234
    btnPinOk.addEventListener("click", () => {
      const val = pinInput.value.trim();
      if (val === "1234") {
        pinError.textContent = "";
        goToFaceStep();
      } else {
        pinError.textContent = "Nesprávný PIN (demo: 1234).";
        pinInput.value = "";
        pinInput.focus();
      }
    });

    pinInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
        btnPinOk.click();
      }
    });

    // TABY
    const tabWallet   = document.getElementById("tabWallet");
    const tabBank     = document.getElementById("tabBank");
    const walletSec   = document.getElementById("walletSection");
    const bankSec     = document.getElementById("bankSection");
    const btnSend     = document.getElementById("btnSend");

    function setMode(mode) {
      if (mode === "wallet") {
        tabWallet.classList.add("active");
        tabBank.classList.remove("active");
        walletSec.style.display = "";
        bankSec.style.display   = "none";
      } else {
        tabWallet.classList.remove("active");
        tabBank.classList.add("active");
        walletSec.style.display = "none";
        bankSec.style.display   = "";
      }
      updateSendState();
    }

    tabWallet.addEventListener("click", () => setMode("wallet"));
    tabBank.addEventListener("click",   () => setMode("bank"));

    // MEZI PENĚŽENKAMI
    const walletRecipient   = document.getElementById("walletRecipient");
    const walletAmount      = document.getElementById("walletAmount");
    const walletStatusBox   = document.getElementById("walletStatus");
    const walletRow         = document.getElementById("walletRow");
    const btnCheck          = document.getElementById("btnCheckRecipient");
    const walletAmountError = document.getElementById("walletAmountError");

    let walletRecipientOk = false;

    btnCheck.addEventListener("click", () => {
      const val = walletRecipient.value.trim();
      walletRecipientOk = false;
      walletStatusBox.innerHTML = "";

      if (!val) return;

      // DEMO logika: pokud obsahuje zavináč → považujeme za existujícího klienta
      if (val.includes("@")) {
        walletRecipientOk = true;
        walletStatusBox.innerHTML =
          '<div class="status-pill ok"><i class="fa-solid fa-circle-check"></i>' +
          'Příjemce ověřen – demo uživatel</div>';
      } else {
        walletStatusBox.innerHTML =
          '<div class="status-pill err"><i class="fa-solid fa-circle-exclamation"></i>' +
          'Příjemce se nepodařilo ověřit.</div>';
      }

      updateSendState();
    });

    // BANKOVNÍ PŘEVOD
    const bankAccount       = document.getElementById("bankAccount");
    const bankCode          = document.getElementById("bankCode");
    const bankAmount        = document.getElementById("bankAmount");
    const bankAmountError   = document.getElementById("bankAmountError");
    const bankRecipientName = document.getElementById("bankRecipientName");
    const vsInput           = document.getElementById("vsInput");
    const ssInput           = document.getElementById("ssInput");
    const ksInput           = document.getElementById("ksInput");
    const msgRecipientInput = document.getElementById("msgRecipientInput");
    const msgMeInput        = document.getElementById("msgMeInput");

    // FOKUS efekty
    const inputRows = document.querySelectorAll(".input-row");
    inputRows.forEach(row => {
      const input = row.querySelector(".text-input");
      if (!input) return;
      input.addEventListener("focus", () => row.classList.add("focused"));
      input.addEventListener("blur",  () => row.classList.remove("focused"));
    });

    function parseAmount(value) {
      const cleaned = value.replace(/\s/g, "").replace(",", ".");
      const num = parseFloat(cleaned);
      return isNaN(num) ? 0 : num;
    }

    // Disponibilní zůstatek dole – podle částky a režimu
    function renderAvailableBalance() {
      if (!sendBalanceEl) return;

      const walletMode = tabWallet.classList.contains("active");
      let available = currentBalance;
      let amt = 0;

      if (walletMode && walletAmount) {
        amt = parseAmount(walletAmount.value.trim());
      } else if (!walletMode && bankAmount) {
        amt = parseAmount(bankAmount.value.trim());
      }

      if (amt > 0) {
        const used = Math.min(amt, currentBalance);
        available = currentBalance - used;
      }

      sendBalanceEl.textContent = formatAmountCZK(available) + " CZK";
    }

    // Sekce po odeslání / šablony – NOVÉ
    const afterSendArea       = document.getElementById("afterSendArea");
    const templatePrimaryArea = document.getElementById("templatePrimaryArea");
    const btnNewPayment       = document.getElementById("btnNewPayment");

    let editingTemplateId = null;   // null = nová šablona, jinak přepisujeme existující

    function clearTemplateUI() {
      editingTemplateId = null;
      afterSendArea.style.display = "none";
      templatePrimaryArea.innerHTML = "";
      btnSend.style.display = ""; // ukázat tlačítko zpět
    }

    function showCreateTemplatePrompt() {
      // po odeslání – tlačítko "Vytvořit šablonu"
      afterSendArea.style.display = "block";
      templatePrimaryArea.innerHTML = `
        <button id="btnCreateTemplate" class="btn-main btn-green" type="button">
          Vytvořit šablonu
        </button>
      `;
      const btnCreateTemplate = document.getElementById("btnCreateTemplate");
      if (btnCreateTemplate) {
        btnCreateTemplate.addEventListener("click", () => {
          showTemplateNameInput();
        });
      }
    }

    function showTemplateNameInput(existingName) {
      // existingName – pokud edituješ, může být naplněné
      afterSendArea.style.display = "block";

      const safeName = existingName ? existingName.replace(/"/g, '&quot;') : "";

      templatePrimaryArea.innerHTML = `
        ${
          existingName
            ? `<div class="template-name-label">Šablona: ${safeName}</div>`
            : `<div class="template-name-label">Nová šablona</div>`
        }
        <div class="save-template-wrapper">
          <input
            id="templateNameInput"
            type="text"
            placeholder="Název šablony"
            value="${safeName}"
          >
          <button
            id="btnSaveTemplate"
            class="btn-main btn-green btn-save-template"
            type="button"
          >
            Uložit šablonu
          </button>
        </div>
      `;
    
      const btnSaveTemplate   = document.getElementById("btnSaveTemplate");
      const templateNameInput = document.getElementById("templateNameInput");
      if (btnSaveTemplate && templateNameInput) {
        btnSaveTemplate.addEventListener("click", () => {
          const name = templateNameInput.value.trim();
          if (!name) {
            templateNameInput.focus();
            return;
          }
          saveTemplateFromForm(name);
        });
      }
    }

    btnNewPayment.addEventListener("click", () => {
      resetBankForm();
      clearTemplateUI();
      updateSendState();
    });

    function resetBankForm() {
      bankAccount.value       = "";
      bankCode.value          = "";
      bankRecipientName.value = "";
      vsInput.value           = "";
      ssInput.value           = "";
      ksInput.value           = "";
      msgRecipientInput.value = "";
      msgMeInput.value        = "";
      bankAmount.value        = "";
    }

    // ŠABLONY – data + localStorage – NOVÉ
    const TEMPLATE_STORAGE_KEY = "rpBankTemplates";

    const DEFAULT_TEMPLATES = [
      {
        id: "tmpl1",
        name: "Nájem",
        account: "1234567890",
        bankCode: "0800",
        recipientName: "Pronajímatel s.r.o.",
        vs: "20240001",
        ss: "",
        ks: "",
        msgRecipient: "Nájemné",
        msgMe: "Nájem byt",
        amount: 12000
      },
      {
        id: "tmpl2",
        name: "Mobilní tarif",
        account: "9876543210",
        bankCode: "0100",
        recipientName: "Moje telefonní společnost a.s.",
        vs: "555555",
        ss: "",
        ks: "",
        msgRecipient: "Faktura za služby",
        msgMe: "Telefon",
        amount: 799
      }
    ];

    let templates = [];

    function loadTemplates() {
      try {
        const stored = localStorage.getItem(TEMPLATE_STORAGE_KEY);
        if (stored) {
          templates = JSON.parse(stored);
        } else {
          templates = DEFAULT_TEMPLATES.slice();
          saveTemplates();
        }
      } catch (e) {
        templates = DEFAULT_TEMPLATES.slice();
      }
    }

    function saveTemplates() {
      try {
        localStorage.setItem(TEMPLATE_STORAGE_KEY, JSON.stringify(templates));
      } catch (e) {
        // ignore
      }
    }

    function renderTemplateTable() {
      const body = document.getElementById("templateTableBody");
      if (!body) return;
      body.innerHTML = "";
      if (!templates.length) {
        const div = document.createElement("div");
        div.style.fontSize = "12px";
        div.style.color = "#777";
        div.style.padding = "8px 4px";
        div.textContent = "Nemáte zatím žádné šablony.";
        body.appendChild(div);
        return;
      }

      templates.forEach(t => {
        const row = document.createElement("div");
        row.className = "template-row";
        row.dataset.id = t.id;

        const colName = document.createElement("div");
        colName.textContent = t.name || "";

        const colAcc = document.createElement("div");
        colAcc.textContent = (t.account || "") + (t.bankCode ? " / " + t.bankCode : "");

        const colVs = document.createElement("div");
        colVs.textContent = t.vs || "";

        const colAmt = document.createElement("div");
        colAmt.textContent = t.amount != null ? formatAmountCZK(Number(t.amount)) + " Kč" : "";

        const colActions = document.createElement("div");
        colActions.className = "template-actions";

        const btnEdit = document.createElement("button");
        btnEdit.className = "template-icon-btn edit";
        btnEdit.type = "button";
        btnEdit.innerHTML = '<i class="fa-solid fa-pen"></i>';

        const btnDelete = document.createElement("button");
        btnDelete.className = "template-icon-btn delete";
        btnDelete.type = "button";
        btnDelete.innerHTML = '<i class="fa-solid fa-trash"></i>';

        colActions.appendChild(btnEdit);
        colActions.appendChild(btnDelete);

        row.appendChild(colName);
        row.appendChild(colAcc);
        row.appendChild(colVs);
        row.appendChild(colAmt);
        row.appendChild(colActions);

        // klik na řádek – načtení šablony
        row.addEventListener("click", () => {
          const tmpl = templates.find(tt => tt.id === t.id);
          if (!tmpl) return;
          fillFormFromTemplate(tmpl);
          closeTemplateModal();
        });

        // edit – přepsat stávající
        btnEdit.addEventListener("click", (e) => {
          e.stopPropagation();
          const tmpl = templates.find(tt => tt.id === t.id);
          if (!tmpl) return;
          fillFormFromTemplate(tmpl);
          closeTemplateModal();
          editingTemplateId = tmpl.id;
          btnSend.style.display = "none"; // upravujeme šablonu, neodesíláme
          showTemplateNameInput(tmpl.name);
        });

        // delete – odstranit šablonu
        btnDelete.addEventListener("click", (e) => {
          e.stopPropagation();
          const index = templates.findIndex(tt => tt.id === t.id);
          if (index !== -1) {
            templates.splice(index, 1);
            saveTemplates();
            renderTemplateTable();
          }
        });

        body.appendChild(row);
      });
    }

    function fillFormFromTemplate(t) {
      bankAccount.value       = t.account || "";
      bankCode.value          = t.bankCode || "";
      bankRecipientName.value = t.recipientName || "";
      vsInput.value           = t.vs || "";
      ssInput.value           = t.ss || "";
      ksInput.value           = t.ks || "";
      msgRecipientInput.value = t.msgRecipient || "";
      msgMeInput.value        = t.msgMe || "";
      bankAmount.value        = t.amount != null ? String(t.amount).replace(".", ",") : "";
      updateSendState();
    }

    function saveTemplateFromForm(name) {
      const tmplData = {
        id: editingTemplateId || ("tmpl_" + Date.now()),
        name,
        account: bankAccount.value.trim(),
        bankCode: bankCode.value.trim(),
        recipientName: bankRecipientName.value.trim(),
        vs: vsInput.value.trim(),
        ss: ssInput.value.trim(),
        ks: ksInput.value.trim(),
        msgRecipient: msgRecipientInput.value.trim(),
        msgMe: msgMeInput.value.trim(),
        amount: parseAmount(bankAmount.value.trim())
      };

      if (editingTemplateId) {
        const idx = templates.findIndex(t => t.id === editingTemplateId);
        if (idx !== -1) {
          templates[idx] = tmplData;
        } else {
          templates.push(tmplData);
        }
      } else {
        templates.push(tmplData);
      }

      saveTemplates();
      renderTemplateTable();
      showNotification("Šablona byla uložena.");
      resetBankForm();
      clearTemplateUI();
      updateSendState();
    }

    // MODAL – template výběr
    const templateBackdrop   = document.getElementById("templateBackdrop");
    const btnOpenTemplates   = document.getElementById("btnOpenTemplates");
    const btnTemplateClose   = document.getElementById("btnTemplateClose");

    function openTemplateModal() {
      templateBackdrop.classList.add("visible");
      renderTemplateTable();
    }

    function closeTemplateModal() {
      templateBackdrop.classList.remove("visible");
    }

    btnOpenTemplates.addEventListener("click", openTemplateModal);
    btnTemplateClose.addEventListener("click", closeTemplateModal);
    templateBackdrop.addEventListener("click", (e) => {
      if (e.target === templateBackdrop) {
        closeTemplateModal();
      }
    });

    // Fotoaparát – demo modal
    const cameraBackdrop = document.getElementById("cameraBackdrop");
    const btnCamera      = document.getElementById("btnCamera");
    const btnCameraClose = document.getElementById("btnCameraClose");
    const btnCameraFill  = document.getElementById("btnCameraFill");

    function openCameraModal() {
      cameraBackdrop.classList.add("visible");
    }

    function closeCameraModal() {
      cameraBackdrop.classList.remove("visible");
    }

    btnCamera.addEventListener("click", openCameraModal);
    btnCameraClose.addEventListener("click", closeCameraModal);
    cameraBackdrop.addEventListener("click", (e) => {
      if (e.target === cameraBackdrop) {
        closeCameraModal();
      }
    });

    btnCameraFill.addEventListener("click", () => {
      bankAccount.value = "1112223339";
      bankCode.value = "0800";
      updateSendState();
      closeCameraModal();
    });

    // LOGIKA enable/disable tlačítka
    function updateSendState() {
      const walletMode = tabWallet.classList.contains("active");
      let enabled = false;

      if (walletMode) {
        const amt = parseAmount(walletAmount.value.trim());
        if (walletAmountError) {
          walletAmountError.classList.toggle("visible", amt > currentBalance && amt > 0);
        }
        enabled = walletRecipientOk && amt > 0 && amt <= currentBalance;
      } else {
        const amt = parseAmount(bankAmount.value.trim());
        const hasAccount       = bankAccount.value.trim().length > 0;
        const hasBankCode      = bankCode.value.trim().length > 0;
        const hasRecipientName = bankRecipientName.value.trim().length > 1;

        if (bankAmountError) {
          bankAmountError.classList.toggle("visible", amt > currentBalance && amt > 0);
        }
        enabled = hasAccount && hasBankCode && hasRecipientName && amt > 0 && amt <= currentBalance;
      }

      renderAvailableBalance();

      if (enabled && btnSend.style.display !== "none") {
        btnSend.disabled = false;
        btnSend.classList.remove("btn-disabled");
      } else {
        btnSend.disabled = true;
        btnSend.classList.add("btn-disabled");
      }
    }

    walletRecipient.addEventListener("input", () => {
      walletRecipientOk = false;
      walletStatusBox.innerHTML = "";
      updateSendState();
    });
    walletAmount.addEventListener("input", updateSendState);
    bankAccount.addEventListener("input", updateSendState);
    bankCode.addEventListener("input", updateSendState);
    bankAmount.addEventListener("input", updateSendState);
    bankRecipientName.addEventListener("input", updateSendState);

    // dokončení transakce po Face ID
    function performTransaction(mode, amt) {
      if (amt <= 0 || amt > currentBalance) {
        updateSendState();
        return;
      }

      currentBalance = Math.max(0, currentBalance - amt);
      renderBalance();
      renderAvailableBalance();

      if (mode === "wallet") {
        showNotification("Demo: odesláno " + formatAmountCZK(amt) + " CZK jiné peněžence RP.");
      } else {
        showNotification("Demo: odesláno " + formatAmountCZK(amt) + " CZK na bankovní účet.");
      }

      // vyčištění polí
      if (mode === "wallet") {
        walletAmount.value = "";
        walletRecipientOk = false;
        walletStatusBox.innerHTML = "";
      } else {
        // neresetujeme hned – necháme data pro případnou šablonu
      }

      // vytvořit novou notifikaci (badge + odemknout řádek)
      showNewNotification();

      // U bankovní platby zobrazíme sekci pro šablony
      if (mode === "bank") {
        btnSend.style.display = "none"; // už neposíláme znovu
        editingTemplateId = null;
        showCreateTemplatePrompt();
      } else {
        clearTemplateUI();
      }

      updateSendState();
    }

    btnFaceOk.addEventListener("click", () => {
      if (!pendingTransaction) {
        closeAuthFlow();
        return;
      }
      // po "Face ID" dokončíme transakci
      performTransaction(pendingTransaction.mode, pendingTransaction.amount);
      closeAuthFlow();
    });

    // Klik na Odeslat platbu – spustí ověřovací flow (PIN + Face ID)
    btnSend.addEventListener("click", () => {
      if (btnSend.disabled) return;

      const walletMode = tabWallet.classList.contains("active");
      let amt = 0;

      if (walletMode) {
        amt = parseAmount(walletAmount.value.trim());
      } else {
        amt = parseAmount(bankAmount.value.trim());
      }

      if (amt <= 0 || amt > currentBalance) {
        updateSendState();
        return;
      }

      openAuthFlow(walletMode ? "wallet" : "bank", amt);
    });

    // animace šipky
    const refreshWrapper = document.querySelector(".card-icon");
    const refreshIcon    = refreshWrapper ? refreshWrapper.querySelector("i") : null;

    if (refreshWrapper && refreshIcon) {
      refreshWrapper.addEventListener("click", () => {
        if (refreshIcon.classList.contains("spinning")) return;
        refreshIcon.classList.add("spinning");
        refreshIcon.addEventListener(
          "animationend",
          () => refreshIcon.classList.remove("spinning"),
          { once: true }
        );
      });
    }

    // inicializace
    loadTemplates();
    setMode("bank");           // default: Bankovní převod vlevo
    renderAvailableBalance();
  </script>
</body>
</html>
