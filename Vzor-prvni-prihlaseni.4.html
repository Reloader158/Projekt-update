<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Onboarding v telefonu</title>
<style>
  :root{
    --blue:#2f74db; --blue-pressed:#2a66bf;
    --accent:#ff7b00; --ok:#1c7a2e; --muted:#6b7280;
    --card:#fff; --shadow:0 20px 60px rgba(0,0,0,.25);
    --phone-w:390px; --phone-h:844px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:#0f1115; display:grid; place-items:center;
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif; color:#111;
  }

  .stage{ width:min(var(--phone-w), 95vw); aspect-ratio:390/844; position:relative; isolation:isolate; max-height:95vh; }
  .phone{ position:absolute; inset:0; border-radius:28px; box-shadow:0 18px 60px rgba(0,0,0,.45); overflow:hidden; background:#000; }
  .screen{ position:absolute; inset:0; background:#000 url('https://github.com/Reloader158/Projekt-update/blob/main/prehled.png?raw=true') center/cover no-repeat; }
  .notch{ position:absolute; top:8px; left:50%; transform:translateX(-50%); width:120px; height:18px; background:#000; border-radius:0 0 12px 12px; opacity:.4; pointer-events:none; z-index:2; }

  .scrim{ position:absolute; inset:0; background:rgba(0,0,0,.38); backdrop-filter:blur(2px); }
  .popup-wrap{ position:absolute; inset:0; display:flex; align-items:center; justify-content:center; padding:18px }
  .popup{ width:min(560px, 92%); background:var(--card); border-radius:20px; box-shadow:var(--shadow); overflow:hidden; }
  .hd{ padding:18px 18px 8px; border-bottom:1px solid #eef0f4 }
  .title{ font-size:18px; font-weight:800 }
  .sub{ color:var(--muted); margin-top:4px; font-size:13px }
  .bd{ padding:14px 18px 6px }
  .row{ display:flex; align-items:center; justify-content:space-between; gap:10px; padding:12px 0; border-bottom:1px solid #f1f3f7 }
  .row:last-child{ border-bottom:none }
  .name{ font-weight:700 }
  .desc{ font-size:12px; color:var(--muted) }
  .status{ font-size:11px; font-weight:700; border-radius:999px; padding:4px 10px; white-space:nowrap }
  .st-bad{ background:#fff2e8; color:#9a4b00 }
  .st-ok{ background:#e8f7ed; color:#116d2b }
  .cta{ border:none; border-radius:999px; padding:10px 12px; font-weight:700; cursor:pointer }
  .cta-prim{ background:var(--blue); color:#fff; box-shadow:0 6px 16px rgba(47,116,219,.25) }
  .cta-ghost{ background:#eef3ff; color:#174796 }
  .actions{ display:flex; gap:10px; padding:14px 18px 18px }
  .btn{ flex:1; border:none; border-radius:999px; padding:12px 14px; font-weight:800; cursor:pointer }
  .btn-sec{ background:#e9e9e9 }
  .btn-primary{ background:var(--blue); color:#fff; box-shadow:0 6px 16px rgba(47,116,219,.25) }
  .btn-primary:active{ background:var(--blue-pressed) }
  .btn-primary[disabled]{ background:#cfd8ef; color:#fff; box-shadow:none; cursor:not-allowed; opacity:.8; pointer-events:none; }

  .footer-links{ display:flex; gap:16px; justify-content:center; padding:0 18px 16px }
  .link{ background:none; border:none; color:#174796; text-decoration:underline; cursor:pointer; font-size:12px }
  .summary{ margin-top:8px; background:#f6f7fb; border-radius:12px; padding:10px 12px; font-size:13px }

  .overlay{ position:absolute; inset:0; background:rgba(0,0,0,.4); display:none; align-items:center; justify-content:center; padding:18px; z-index:30 }
  .modal{ width:min(400px, 92%); background:#fff; border-radius:20px; box-shadow:var(--shadow); overflow:hidden }
  .m-hd{ padding:16px 18px; border-bottom:1px solid #eef0f4; font-weight:800 }
  .m-bd{ padding:16px 18px }
  .field{ margin:10px 0 }
  .label{ font-size:13px; margin-bottom:6px }
  input[type="password"], input[type="text"]{ width:100%; padding:12px; border:1px solid #e5e7eb; border-radius:12px; font-size:16px }
  .error{ display:none; margin-top:8px; font-size:12px; background:#fdecea; border:1px solid #f5c2c0; color:#c62828; border-radius:10px; padding:8px 10px }
  .m-actions{ display:flex; gap:10px; margin-top:12px }
  .m-btn{ flex:1; border:none; border-radius:999px; padding:10px 12px; font-weight:700; cursor:pointer }
  .m-sec{ background:#e9e9e9 }
  .m-ok{ background:var(--blue); color:#fff }

  .ios-overlay{ position:absolute; inset:0; background:rgba(0,0,0,.25); backdrop-filter:blur(4px); display:none; align-items:center; justify-content:center; padding:18px; z-index:40 }
  .ios-alert{ width:min(400px, 92%); background:#fff; border-radius:22px; box-shadow:var(--shadow); overflow:hidden; text-align:center }
  .ios-body{ padding:22px 18px 16px }
  .ios-title{ font-weight:700; font-size:17px; line-height:1.35; margin-bottom:10px }
  .ios-text{ font-size:14px; opacity:.9 }
  .ios-actions{ display:flex; border-top:1px solid #e8e8ed }
  .ios-btn{ flex:1; padding:14px 8px; font-size:17px; color:#0a62ff; background:#fff; border:none; cursor:pointer }
  .ios-btn + .ios-btn{ border-left:1px solid #e8e8ed }

  .toast{ position:absolute; left:50%; bottom:22px; transform:translateX(-50%); background:#111; color:#fff; padding:8px 12px; border-radius:12px; opacity:0; transition:.25s; pointer-events:none; z-index:60; font-size:13px }
  .toast.show{ opacity:1 }

  /* ✅ mini dev toolbar pro přepínání stavů biometrie */
  .devbar{
    position:absolute; left:10px; right:10px; bottom:10px; z-index:70;
    display:flex; gap:8px; align-items:center;
    background:rgba(17,17,17,.65); color:#fff; padding:8px 10px; border-radius:12px;
    backdrop-filter: blur(2px);
    font-size:12px;
  }
  .devbar select{
    flex:1; padding:6px 8px; border-radius:8px; border:1px solid #555; background:#fff; color:#111;
  }

  @keyframes shake{10%,90%{transform:translateX(-1px)}20%,80%{transform:translateX(2px)}30%,50%,70%{transform:translateX(-4px)}40%,60%{transform:translateX(4px)}}
  .shake{ animation:shake .35s linear }
</style>
</head>
<body>

  <div class="stage">
    <div class="phone">
      <div class="screen"></div>
      <div class="notch"></div>

      <!-- onboarding popup -->
      <div class="scrim"></div>
      <div class="popup-wrap" id="onboard">
        <div class="popup">
          <div class="hd">
            <div class="title">Vítejte v aplikaci Rychlá Peněženka</div>
            <div class="sub">Nastavte si <b>PIN</b> a povolte <b>Face ID / Otisk</b> pro rychlé a bezpečné ověřování.</div>
          </div>

          <div class="bd">
            <div class="row" id="rowPin">
              <div>
                <div class="name">PIN</div>
                <div class="desc">Krátký osobní kód pro přihlášení a potvrzování</div>
              </div>
              <div style="display:flex;gap:8px;align-items:center">
                <span id="pinStatus" class="status st-bad">Nenastaveno</span>
                <button id="btnPin" class="cta cta-prim">Nastavit PIN</button>
              </div>
            </div>

            <div class="row" id="rowBio">
              <div>
                <div class="name">Biometrie</div>
                <div class="desc">Face ID nebo otisk prstu pro pohodlné ověřování</div>
              </div>
              <div style="display:flex;gap:8px;align-items:center">
                <span id="bioStatus" class="status st-bad">Nenastaveno</span>
                <button id="btnBio" class="cta cta-ghost">Povolit biometrii</button>
              </div>
            </div>

            <div id="sum" class="summary" style="display:none">
              <b>Hotovo.</b> Budeme ověřovat: <span id="combo">PIN + Biometrie</span>. V Nastavení to můžete kdykoli změnit.
            </div>
          </div>

          <div class="actions">
            <button id="later" class="btn btn-sec">Připomenout později</button>
            <button id="continue" class="btn btn-primary" disabled aria-disabled="true">Pokračovat do nastavení</button>
          </div>
          <div class="footer-links">
            <button id="noThanks" class="link">Nechci</button>
          </div>
        </div>
      </div>

      <!-- MODAL: PIN (demo) -->
      <div class="overlay" id="pinModal">
        <div class="modal">
          <div class="m-hd">Vytvořte si PIN</div>
          <div class="m-bd">
            <div class="label">Zadejte 4–6 číslic (pro demo napište 1111)</div>
            <div class="field"><input id="pin1" type="password" inputmode="numeric" placeholder="Nový PIN"></div>
            <div class="field"><input id="pin2" type="password" inputmode="numeric" placeholder="Potvrdit PIN"></div>
            <div id="pinErr" class="error">PINy se neshodují nebo jsou neplatné.</div>
            <div class="m-actions">
              <button id="pinCancel" class="m-btn m-sec">Zrušit</button>
              <button id="pinSave" class="m-btn m-ok">Uložit PIN</button>
            </div>
          </div>
        </div>
      </div>

      <!-- iOS-like biometrie: souhlas -->
      <div class="ios-overlay" id="bioAlert">
        <div class="ios-alert">
          <div class="ios-body">
            <div class="ios-title">Chcete aplikaci „Rychlá Peněženka“ povolit používat Face ID / otisk prstu?</div>
            <div class="ios-text">Biometrie umožní rychlé ověřování pro přihlášení a potvrzování.</div>
          </div>
          <div class="ios-actions">
            <button id="bioDeny" class="ios-btn">Nepovolit</button>
            <button id="bioAllow" class="ios-btn">Povolit</button>
          </div>
        </div>
      </div>

      <!-- iOS-like: zařízení NEPODPORUJE biometriku -->
      <div class="ios-overlay" id="bioUnsupported">
        <div class="ios-alert">
          <div class="ios-body">
            <div class="ios-title">Biometrie není na tomto zařízení k dispozici</div>
            <div class="ios-text">Telefon nepodporuje Face ID ani otisk prstu. Pro pokračování použijte jiný způsob ověřování.</div>
          </div>
          <div class="ios-actions">
            <button class="ios-btn" id="bioUnsupBack">Zpět</button>
          </div>
        </div>
      </div>

      <!-- iOS-like: biometrie podporovaná, ale NENÍ nastavená -->
      <div class="ios-overlay" id="bioNotEnrolled">
        <div class="ios-alert">
          <div class="ios-body">
            <div class="ios-title">Biometrie není v telefonu nastavená</div>
            <div class="ios-text">Abyste mohli používat Face ID / otisk v aplikaci, nejdřív ji nastavte v nastavení telefonu.</div>
          </div>
          <div class="ios-actions">
            <button class="ios-btn" id="bioEnrollBack">Zpět</button>
            <button class="ios-btn" id="bioGoSettings">Přejít do nastavení</button>
          </div>
        </div>
      </div>

      <div class="toast" id="toast">Uloženo</div>

      <!-- ✅ DEV TOOLBAR: přepnutí stavu biometrie -->
      <div class="devbar">
        <span>Test: Stav biometrie</span>
        <select id="bioState">
          <option value="ok">Podporováno & nastaveno</option>
          <option value="noEnroll" selected>Podporováno & nenastaveno</option>
          <option value="noSupport">Nepodporováno (skrýt řádek)</option>
        </select>
      </div>

    </div>
  </div>

<script>
  let hasPin=false, hasBio=false;

  // SIMULACE stavu zařízení (mění se dropdownem)
  let deviceSupportsBio = true;   // telefon umí Face/otisk?
  let osBioEnrolled    = false;   // Face/otisk nastaven v OS?

  const pinStatus=document.getElementById('pinStatus');
  const bioStatus=document.getElementById('bioStatus');
  const btnPin=document.getElementById('btnPin');
  const btnBio=document.getElementById('btnBio');
  const btnContinue=document.getElementById('continue');
  const sum=document.getElementById('sum');
  const rowBio=document.getElementById('rowBio');

  const bioAlert = document.getElementById('bioAlert');
  const bioUnsupported = document.getElementById('bioUnsupported');
  const bioNotEnrolled = document.getElementById('bioNotEnrolled');

  function applyBioVisibility(){
  // skryj/ukaž řádek Biometrie v hlavním popupu
  rowBio.style.display = deviceSupportsBio ? '' : 'none';
  const sub = document.querySelector('.sub');
  if(!deviceSupportsBio){
    sub.innerHTML = 'Nastavte si <b>PIN</b> pro rychlé a bezpečné ověřování.';
    hasBio = false;
  } else {
    sub.innerHTML = 'Nastavte si <b>PIN</b> a povolte <b>Face ID / Otisk</b> pro rychlé a bezpečné ověřování.';
  }
  updateUI();
}

  function updateUI(){
    pinStatus.textContent = hasPin ? 'Připraveno' : 'Nenastaveno';
    pinStatus.className = 'status ' + (hasPin?'st-ok':'st-bad');
    btnPin.textContent   = hasPin ? 'Změnit PIN' : 'Nastavit PIN';
    btnPin.className     = 'cta ' + (hasPin?'cta-ghost':'cta-prim');

    bioStatus.textContent = hasBio ? 'Připraveno' : 'Nenastaveno';
    bioStatus.className   = 'status ' + (hasBio?'st-ok':'st-bad');
    btnBio.textContent    = hasBio ? 'Změnit nastavení' : 'Povolit biometrii';
    btnBio.className      = 'cta ' + (hasBio?'cta-prim':'cta-ghost');

    const both = hasPin && hasBio;
    btnContinue.disabled = !both;
    btnContinue.setAttribute('aria-disabled', String(!both));
    sum.style.display = both ? 'block' : 'none';
  }

  function toast(msg){
    const t=document.getElementById('toast'); t.textContent=msg; t.classList.add('show');
    clearTimeout(toast._t); toast._t=setTimeout(()=>t.classList.remove('show'),1800);
  }

  // PIN modal (demo: platný PIN = 1111)
  const pinModal=document.getElementById('pinModal');
  const pin1=document.getElementById('pin1'); const pin2=document.getElementById('pin2'); const pinErr=document.getElementById('pinErr');

  btnPin.addEventListener('click', ()=>{ pinModal.style.display='flex'; pin1.value=''; pin2.value=''; pinErr.style.display='none'; pin1.focus(); });
  document.getElementById('pinCancel').addEventListener('click', ()=> pinModal.style.display='none');
  document.getElementById('pinSave').addEventListener('click', ()=>{
    const a=pin1.value.trim(), b=pin2.value.trim();
    const valid = a.length>=4 && a.length<=6 && a===b && a==='1111';
    if(!valid){ pinErr.style.display='block'; pinModal.querySelector('.modal').classList.remove('shake'); void pinModal.offsetWidth; pinModal.querySelector('.modal').classList.add('shake'); return; }
    hasPin=true; pinModal.style.display='none'; updateUI(); toast('PIN nastaven');
  });
  [pin1,pin2].forEach(el=> el.addEventListener('keydown', e=>{ if(e.key==='Enter') document.getElementById('pinSave').click(); }));

  // Biometrie – tři stavy
  btnBio.addEventListener('click', () => {
    if (!deviceSupportsBio) {               // 1) nepodporuje
      bioUnsupported.style.display = 'flex';
      return;
    }
    if (!osBioEnrolled) {                   // 2) podporuje, ale není nastaveno
      bioNotEnrolled.style.display = 'flex';
      return;
    }
    bioAlert.style.display = 'flex';        // 3) vše OK → souhlas
  });

  // Zavírání dialogů
  document.getElementById('bioUnsupBack').addEventListener('click', ()=> {
    bioUnsupported.style.display = 'none';
  });
  document.getElementById('bioEnrollBack').addEventListener('click', ()=> {
    bioNotEnrolled.style.display = 'none';
  });
  document.getElementById('bioGoSettings').addEventListener('click', ()=> {
    toast('Otevřete Nastavení telefonu → Zabezpečení → Biometrie.');
    bioNotEnrolled.style.display = 'none';
  });

  document.getElementById('bioDeny').addEventListener('click', ()=> bioAlert.style.display='none');
  document.getElementById('bioAllow').addEventListener('click', ()=>{ 
    hasBio=true; 
    bioAlert.style.display='none'; 
    updateUI(); 
    toast('Biometrie povolena'); 
  });

  // spodní akce
  document.getElementById('later').addEventListener('click', ()=>{ toast('Připomeneme později'); document.getElementById('onboard').style.display='none'; });
  document.getElementById('noThanks').addEventListener('click', ()=>{ toast('Můžete kdykoli změnit v Nastavení'); document.getElementById('onboard').style.display='none'; });
  btnContinue.addEventListener('click', ()=>{ if(btnContinue.disabled) return; toast('Hotovo – PIN + Biometrie'); document.getElementById('onboard').style.display='none'; });

  // ✅ Dev dropdown – přepínání stavů biometrie
  const bioState = document.getElementById('bioState');
  bioState.addEventListener('change', (e)=>{
    const v = e.target.value;
    if(v==='ok'){ deviceSupportsBio=true; osBioEnrolled=true; }
    if(v==='noEnroll'){ deviceSupportsBio=true; osBioEnrolled=false; }
    if(v==='noSupport'){ deviceSupportsBio=false; osBioEnrolled=false; hasBio=false; }
    // zavři případné otevřené dialogy
    [bioAlert,bioUnsupported,bioNotEnrolled].forEach(el=> el.style.display='none');
    applyBioVisibility();
    toast('Režim biometrie: ' + e.target.options[e.target.selectedIndex].text);
  });

  // init
  applyBioVisibility();
</script>
</body>
</html>
